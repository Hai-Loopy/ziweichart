<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birth Chart Generator</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        h1, h2 {
            color: #333;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        .fields {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .fields > div {
            flex: 1;
            min-width: 200px;
        }
        
        .calendar-data {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        .calendar-data h3 {
            margin-top: 0;
            color: #333;
        }
        
        .data-section {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 10px;
        }
        
        .data-card {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .data-card h4 {
            margin-top: 0;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        table, th, td {
            border: 1px solid #ddd;
        }
        
        th, td {
            padding: 8px;
            text-align: left;
        }
        
        th {
            background-color: #f2f2f2;
        }
        
        .element-water { color: #1e88e5; }
        .element-wood { color: #43a047; }
        .element-fire { color: #e53935; }
        .element-earth { color: #8d6e63; }
        .element-metal { color: #757575; }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .nav-buttons button {
            width: 48%;
        }
        
        .chart-note {
            margin-top: 20px;
            padding: 10px;
            background-color: #fff8dc;
            border-left: 4px solid #ffd700;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Birth Chart Generator</h1>
        <p>Enter birth information to generate Chinese calendar data needed for Zi Wei Dou Shu charts.</p>
        
        <div class="fields">
            <div class="form-group">
                <label for="year">Year of Birth:</label>
                <input type="number" id="year" min="1900" max="2100" value="2025">
            </div>
            
            <div class="form-group">
                <label for="month">Month of Birth:</label>
                <select id="month">
                    <option value="1">January</option>
                    <option value="2" selected>February</option>
                    <option value="3">March</option>
                    <option value="4">April</option>
                    <option value="5">May</option>
                    <option value="6">June</option>
                    <option value="7">July</option>
                    <option value="8">August</option>
                    <option value="9">September</option>
                    <option value="10">October</option>
                    <option value="11">November</option>
                    <option value="12">December</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="day">Day of Birth:</label>
                <input type="number" id="day" min="1" max="31" value="11">
            </div>
            
            <div class="form-group">
                <label for="hour">Hour of Birth:</label>
                <select id="hour">
                    <option value="1">23:00-00:59 (Rat/子 Hour)</option>
                    <option value="2">01:00-02:59 (Ox/丑 Hour)</option>
                    <option value="3">03:00-04:59 (Tiger/寅 Hour)</option>
                    <option value="4">05:00-06:59 (Rabbit/卯 Hour)</option>
                    <option value="5">07:00-08:59 (Dragon/辰 Hour)</option>
                    <option value="6" selected>09:00-10:59 (Snake/巳 Hour)</option>
                    <option value="7">11:00-12:59 (Horse/午 Hour)</option>
                    <option value="8">13:00-14:59 (Goat/未 Hour)</option>
                    <option value="9">15:00-16:59 (Monkey/申 Hour)</option>
                    <option value="10">17:00-18:59 (Rooster/酉 Hour)</option>
                    <option value="11">19:00-20:59 (Dog/戌 Hour)</option>
                    <option value="12">21:00-22:59 (Pig/亥 Hour)</option>
                </select>
            </div>
        </div>
        
        <button id="generate-btn">Generate Birth Chart Data</button>
        
        <div id="calendar-data" class="calendar-data" style="display: none;">
            <h3>Chinese Calendar Data</h3>
            
            <div class="data-section">
                <div class="data-card">
                    <h4>Year Data</h4>
                    <div id="year-data">
                        <p><strong>Year Stem:</strong> <span id="year-stem"></span></p>
                        <p><strong>Year Branch:</strong> <span id="year-branch"></span></p>
                        <p><strong>Year Zodiac:</strong> <span id="year-zodiac"></span></p>
                        <p><strong>Element:</strong> <span id="year-element"></span></p>
                    </div>
                </div>
                
                <div class="data-card">
                    <h4>Birth Palace Information</h4>
                    <div id="palace-data">
                        <p><strong>Birth Palace:</strong> <span id="birth-palace"></span></p>
                        <p><strong>Body Palace:</strong> <span id="body-palace"></span></p>
                        <p><strong>Birth Palace Formula:</strong> (Month + Hour - 2) % 12</p>
                        <p><strong>Calculation:</strong> <span id="palace-calculation"></span></p>
                    </div>
                </div>
            </div>
            
            <h3>Eight Characters (Ba Zi)</h3>
            <table>
                <thead>
                    <tr>
                        <th>Year</th>
                        <th>Month</th>
                        <th>Day</th>
                        <th>Hour</th>
                    </tr>
                </thead>
                <tbody>
                    <tr id="stems-row">
                        <td id="year-stem-cell"></td>
                        <td id="month-stem-cell"></td>
                        <td id="day-stem-cell"></td>
                        <td id="hour-stem-cell"></td>
                    </tr>
                    <tr id="branches-row">
                        <td id="year-branch-cell"></td>
                        <td id="month-branch-cell"></td>
                        <td id="day-branch-cell"></td>
                        <td id="hour-branch-cell"></td>
                    </tr>
                </tbody>
            </table>
            
            <div class="chart-note">
                <p><strong>Note:</strong> This data is essential for generating your Zi Wei Dou Shu chart. Use the "Go to Chart Generator" button below to input this information into the chart calculator.</p>
            </div>
            
            <div class="nav-buttons">
                <button id="new-calculation-btn">New Calculation</button>
                <button id="goto-chart-btn">Go to Chart Generator</button>
            </div>
        </div>
    </div>

    <script>
        // Stem and Branch data
        const stems = {
            chinese: ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'],
            pinyin: ['Jia', 'Yi', 'Bing', 'Ding', 'Wu', 'Ji', 'Geng', 'Xin', 'Ren', 'Gui'],
            elements: ['Wood', 'Wood', 'Fire', 'Fire', 'Earth', 'Earth', 'Metal', 'Metal', 'Water', 'Water'],
            yin_yang: ['Yang', 'Yin', 'Yang', 'Yin', 'Yang', 'Yin', 'Yang', 'Yin', 'Yang', 'Yin']
        };
        
        const branches = {
            chinese: ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'],
            pinyin: ['Zi', 'Chou', 'Yin', 'Mao', 'Chen', 'Si', 'Wu', 'Wei', 'Shen', 'You', 'Xu', 'Hai'],
            zodiac: ['Rat', 'Ox', 'Tiger', 'Rabbit', 'Dragon', 'Snake', 'Horse', 'Goat', 'Monkey', 'Rooster', 'Dog', 'Pig'],
            elements: ['Water', 'Earth', 'Wood', 'Wood', 'Earth', 'Fire', 'Fire', 'Earth', 'Metal', 'Metal', 'Earth', 'Water']
        };
        
        const palaceNames = [
            '命宮 (Life Palace)', 
            '兄弟宮 (Siblings Palace)', 
            '夫妻宮 (Spouse Palace)', 
            '子女宮 (Children Palace)',
            '財帛宮 (Wealth Palace)', 
            '疾厄宮 (Health Palace)', 
            '遷移宮 (Travel Palace)', 
            '交友宮 (Friends Palace)',
            '官祿宮 (Career Palace)', 
            '田宅宮 (Property Palace)', 
            '福德宮 (Fortune Palace)', 
            '父母宮 (Parents Palace)'
        ];
        
        // Calculate Chinese calendar data
        function calculateChineseCalendarData(year, month, day, hour) {
            // Year calculations
            const stemIndex = (year - 4) % 10;
            const branchIndex = (year - 4) % 12;
            
            // Month stem and branch
            // This is a simplified calculation - actual lunar month calculation is more complex
            const monthStemIndex = (year * 2 + month) % 10;
            const monthBranchIndex = (month + 2 - 1) % 12;
            
            // Day stem and branch (simplified)
            // In a real system, this would use a complex algorithm or lookup table
            const dayStemIndex = (year + month + day) % 10;
            const dayBranchIndex = (day - 1) % 12;
            
            // Hour stem and branch
            const hourStemIndex = (dayStemIndex * 2 + hour) % 10;
            const hourBranchIndex = (hour - 1) % 12;
            
            // Calculate birth palace
            const birthPalace = calculateBirthPalace(month, hour);
            const bodyPalace = calculateBodyPalace(birthPalace);
            
            return {
                year: {
                    stem: {
                        chinese: stems.chinese[stemIndex],
                        pinyin: stems.pinyin[stemIndex],
                        element: stems.elements[stemIndex],
                        yin_yang: stems.yin_yang[stemIndex]
                    },
                    branch: {
                        chinese: branches.chinese[branchIndex],
                        pinyin: branches.pinyin[branchIndex],
                        zodiac: branches.zodiac[branchIndex],
                        element: branches.elements[branchIndex]
                    },
                    index: {
                        stem: stemIndex,
                        branch: branchIndex
                    }
                },
                month: {
                    stem: {
                        chinese: stems.chinese[monthStemIndex],
                        pinyin: stems.pinyin[monthStemIndex]
                    },
                    branch: {
                        chinese: branches.chinese[monthBranchIndex],
                        pinyin: branches.pinyin[monthBranchIndex]
                    }
                },
                day: {
                    stem: {
                        chinese: stems.chinese[dayStemIndex],
                        pinyin: stems.pinyin[dayStemIndex]
                    },
                    branch: {
                        chinese: branches.chinese[dayBranchIndex],
                        pinyin: branches.pinyin[dayBranchIndex]
                    }
                },
                hour: {
                    stem: {
                        chinese: stems.chinese[hourStemIndex],
                        pinyin: stems.pinyin[hourStemIndex]
                    },
                    branch: {
                        chinese: branches.chinese[hourBranchIndex],
                        pinyin: branches.pinyin[hourBranchIndex]
                    }
                },
                palace: {
                    birth: birthPalace,
                    body: bodyPalace,
                    birthName: palaceNames[birthPalace - 1],
                    bodyName: palaceNames[bodyPalace - 1],
                    calculation: `(${month} + ${hour} - 2) % 12 = ${birthPalace}`
                }
            };
        }
        
        // Calculate Birth Palace
        function calculateBirthPalace(month, hour) {
            let position = (month + hour - 2) % 12;
            if (position <= 0) position += 12;
            return position;
        }
        
        // Calculate Body Palace
        function calculateBodyPalace(birthPalace) {
            return ((birthPalace + 6 - 1) % 12) + 1;
        }
        
        // Get element CSS class
        function getElementClass(element) {
            const elementClasses = {
                'Wood': 'element-wood',
                'Fire': 'element-fire',
                'Earth': 'element-earth',
                'Metal': 'element-metal',
                'Water': 'element-water'
            };
            
            return elementClasses[element] || '';
        }
        
        // Display calendar data
        function displayCalendarData(data) {
            // Show the data section
            document.getElementById('calendar-data').style.display = 'block';
            
            // Year data
            document.getElementById('year-stem').textContent = `${data.year.stem.chinese} (${data.year.stem.pinyin})`;
            document.getElementById('year-branch').textContent = `${data.year.branch.chinese} (${data.year.branch.pinyin})`;
            document.getElementById('year-zodiac').textContent = data.year.branch.zodiac;
            
            const yearElement = document.getElementById('year-element');
            yearElement.textContent = `${data.year.stem.element} ${data.year.stem.yin_yang}`;
            yearElement.className = getElementClass(data.year.stem.element);
            
            // Palace data
            document.getElementById('birth-palace').textContent = `Palace ${data.palace.birth} - ${data.palace.birthName}`;
            document.getElementById('body-palace').textContent = `Palace ${data.palace.body} - ${data.palace.bodyName}`;
            document.getElementById('palace-calculation').textContent = data.palace.calculation;
            
            // BaZi table
            document.getElementById('year-stem-cell').textContent = `${data.year.stem.chinese} (${data.year.stem.pinyin})`;
            document.getElementById('year-stem-cell').className = getElementClass(data.year.stem.element);
            
            document.getElementById('month-stem-cell').textContent = `${data.month.stem.chinese} (${data.month.stem.pinyin})`;
            document.getElementById('day-stem-cell').textContent = `${data.day.stem.chinese} (${data.day.stem.pinyin})`;
            document.getElementById('hour-stem-cell').textContent = `${data.hour.stem.chinese} (${data.hour.stem.pinyin})`;
            
            document.getElementById('year-branch-cell').textContent = `${data.year.branch.chinese} (${data.year.branch.pinyin})`;
            document.getElementById('year-branch-cell').className = getElementClass(data.year.branch.element);
            
            document.getElementById('month-branch-cell').textContent = `${data.month.branch.chinese} (${data.month.branch.pinyin})`;
            document.getElementById('day-branch-cell').textContent = `${data.day.branch.chinese} (${data.day.branch.pinyin})`;
            document.getElementById('hour-branch-cell').textContent = `${data.hour.branch.chinese} (${data.hour.branch.pinyin})`;
        }
        
        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Generate button
            document.getElementById('generate-btn').addEventListener('click', function() {
                const year = parseInt(document.getElementById('year').value);
                const month = parseInt(document.getElementById('month').value);
                const day = parseInt(document.getElementById('day').value);
                const hour = parseInt(document.getElementById('hour').value);
                
                const data = calculateChineseCalendarData(year, month, day, hour);
                displayCalendarData(data);
            });
            
            // New calculation button
            document.getElementById('new-calculation-btn').addEventListener('click', function() {
                document.getElementById('calendar-data').style.display = 'none';
            });
            
            // Go to chart generator button
            document.getElementById('goto-chart-btn').addEventListener('click', function() {
                window.location.href = 'index.html';
            });
        });
    </script>
</body>
</html>
